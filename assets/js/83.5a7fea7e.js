(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{463:function(t,a,s){"use strict";s.r(a);var e=s(51),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"ontop-with-dremio"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ontop-with-dremio"}},[t._v("#")]),t._v(" Ontop with Dremio")]),t._v(" "),s("p",[t._v("In this tutorial we present step-by-step the way of connecting Dremio to Ontop. We show how to integrate "),s("em",[t._v("uni1")]),t._v(" data saved in the PostgreSQL database and "),s("em",[t._v("uni2")]),t._v(" data saved in plain JSON files into one Dremio data space.")]),t._v(" "),s("p",[t._v("We provide a Docker-compose script, which is both launching Dremio and the PostgreSQL database.\nGo at the root of the "),s("RouterLink",{attrs:{to:"/tutorial/#clone-this-repository"}},[t._v("ontop-tutorial git repository")]),t._v(" and run the following commands:")],1),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" federation/dremio\ndocker-compose pull "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" docker-compose up --build\n")])])]),s("p",[t._v("Once Dremio is initialized, visit "),s("a",{attrs:{href:"http://localhost:9047",target:"_blank",rel:"noopener"}},[t._v("http://localhost:9047"),s("OutboundLink")],1),t._v(". Before you continue, we recommend you to see the following tutorials provided by Dremio:")]),t._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"https://www.dremio.com/tutorials/getting-oriented-to-dremio/",target:"_blank",rel:"noopener"}},[t._v("Getting oriented with Dremio"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.dremio.com/tutorials/working-with-your-first-dataset/",target:"_blank",rel:"noopener"}},[t._v("Working with your first dataset"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("By following the instructions in "),s("a",{attrs:{href:"https://www.dremio.com/tutorials/working-with-your-first-dataset/",target:"_blank",rel:"noopener"}},[t._v("Working with your first dataset"),s("OutboundLink")],1),t._v(", we create a "),s("em",[t._v("space")]),t._v(" named "),s("strong",[t._v("university")]),t._v(" as shown below.")]),t._v(" "),s("p",[t._v("Add and save the new data space:")]),t._v(" "),s("img",{attrs:{src:"img/add-space.png",width:"300"}}),t._v(" "),s("p",[t._v("It will be our data space in which we integrate data from various sources.")]),t._v(" "),s("p",[t._v("The "),s("em",[t._v("uni1")]),t._v(" data is contained in a PostgreSQL database named "),s("em",[t._v("university-session1")]),t._v(".\nWe are ready to add our database as a new datasource into Dremio:")]),t._v(" "),s("img",{attrs:{src:"img/add-external-source.png",width:"300"}}),t._v(" "),s("p",[t._v("Select PostgreSQL:")]),t._v(" "),s("img",{attrs:{src:"img/add-postgres-external.png",width:"700"}}),t._v(" "),s("p",[t._v("Enter the required JDBC information (password: "),s("em",[t._v("postgres")]),t._v("):")]),t._v(" "),s("img",{attrs:{src:"img/postgres-info.png",width:"700"}}),t._v(" "),s("p",[t._v("Now we see the tables in "),s("em",[t._v("university-session1")]),t._v(":")]),t._v(" "),s("img",{attrs:{src:"img/postgres-tables.png",width:"600"}}),t._v(" "),s("p",[t._v("We add the table "),s("em",[t._v("course-registration")]),t._v(" as dataset into "),s("em",[t._v("university")]),t._v(". We rename it to "),s("em",[t._v("uni1-registration")]),t._v(".")]),t._v(" "),s("img",{attrs:{src:"img/postgres-uni1-registration-dataset.png",width:"600"}}),t._v(" "),s("p",[t._v("Save the other datasets in similar manner.")]),t._v(" "),s("p",[t._v("Now we add the "),s("em",[t._v("uni2")]),t._v(" data from "),s("a",{attrs:{href:"data/uni2.json"}},[t._v("here")]),t._v(" as a JSON data source:")]),t._v(" "),s("img",{attrs:{src:"img/add-json.png",width:"600"}}),t._v(" "),s("p",[t._v("The "),s("em",[t._v("uni2")]),t._v(" JSON data can be seen as follows:")]),t._v(" "),s("img",{attrs:{src:"img/see-json.png",width:"800"}}),t._v(" "),s("p",[t._v("JSON files usually contain nested data. However, Ontop cannot directly query nested data. For this reason, in order to make our JSON data queryable by Ontop, first we need to extract relevant group of elements, and save these groups as datasets.")]),t._v(" "),s("p",[t._v("With the following SQL query we create an "),s("em",[t._v("uni2-registration")]),t._v(" dataset and save it into the data space "),s("em",[t._v("university")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" T"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" T"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("enrollers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pid "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" pid \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" cid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flatten"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enrollers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" enrollers \n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" uni2\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" T\n")])])]),s("p",[t._v("The following SQL expression flattens the array of enrollers:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[t._v("flatten"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enrollers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" enrollers\n")])])]),s("p",[s("em",[t._v("Save As")]),t._v(" the data set with the name "),s("em",[t._v("uni2-registration")]),t._v(".")]),t._v(" "),s("img",{attrs:{src:"img/uni2-registration.png",width:"800"}}),t._v(" "),s("p",[t._v("Create a dataset named "),s("em",[t._v("uni2-course")]),t._v(" in a similar manner:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" course"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cid "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" uni2\n")])])]),s("p",[t._v("Create a "),s("em",[t._v("uni2-student")]),t._v(" dataset with a bit more involved SQL that flattens the array of students:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" T"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("enrollers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pid"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" pid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("T"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("enrollers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fname"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" fname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" T"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("enrollers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lname"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" lname \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" flatten"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enrollers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" enrollers\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" uni2\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" T\n")])])]),s("p",[t._v("Create "),s("em",[t._v("uni2-teaching")]),t._v(" dataset with the following SQL:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" cid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uni2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lecturer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pid "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" pid\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" uni2\n")])])]),s("p",[t._v("Now we can list all the datasets we saved in the "),s("em",[t._v("university")]),t._v(" space:")]),t._v(" "),s("img",{attrs:{src:"img/dataset-list-updated.png",width:"600"}}),t._v(" "),s("p",[t._v("Finally we are ready to connect Dremio to Ontop. Dremio can be connected to Ontop through its JDBC interface. By following the instructions provided in "),s("a",{attrs:{href:"https://docs.dremio.com/drivers/dremio-jdbc-driver.html",target:"_blank",rel:"noopener"}},[t._v("here"),s("OutboundLink")],1),t._v(', we provide  to Ontop the following JDBC connection information in a ".properties file" for a Dremio instance running on the localhost:')]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("jdbc.url=jdbc\\:dremio\\:direct\\=localhost\\:31010\njdbc.driver=com.dremio.jdbc.Driver\njdbc.user=dremiotest\njdbc.password=dremiotest\n")])])]),s("p",[t._v("Dremio JDBC driver can be downloaded from "),s("a",{attrs:{href:"https://www.dremio.com/drivers/",target:"_blank",rel:"noopener"}},[t._v("here"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("Over an OBDA setting containing the following mapping assertions:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('[PrefixDeclaration]\n:\t\thttp://example.org/voc#\nex:\t\thttp://example.org/\nowl:\t\thttp://www.w3.org/2002/07/owl#\nrdf:\t\thttp://www.w3.org/1999/02/22-rdf-syntax-ns#\nxml:\t\thttp://www.w3.org/XML/1998/namespace\nxsd:\t\thttp://www.w3.org/2001/XMLSchema#\nfoaf:\t\thttp://xmlns.com/foaf/0.1/\nobda:\t\thttps://w3id.org/obda/vocabulary#\nrdfs:\t\thttp://www.w3.org/2000/01/rdf-schema#\n\n[MappingDeclaration] @collection [[\nmappingId\tuni1-student\ntarget\t\t:uni1/student/{s_id} a :Student ; foaf:firstName {first_name}^^xsd:string ; foaf:lastName {last_name}^^xsd:string . \nsource\t\tSELECT * FROM "university"."uni1-student"\n\nmappingId\tuni1-attends\ntarget\t\t:uni1/student/{s_id} :attends :uni1/course/{c_id}/{title} .\nsource\t\tSELECT "uni1-registration".s_id, "uni1-course".c_id, "uni1-course".title FROM "university"."uni1-registration", "university"."uni1-course" WHERE "uni1-registration".c_id = "uni1-course".c_id\n\nmappingId\tuni2-student\ntarget\t\t:uni2/student/{pid} a :Student ; foaf:firstName {fname}^^xsd:string ; foaf:lastName {lname}^^xsd:string . \nsource\t\tSELECT * FROM "university"."uni2-student"\n\nmappingId\tuni2-attends\ntarget\t\t:uni2/student/{pid} :attends :uni2/course/{cid}/{course} .\nsource\t\tSELECT "uni2-registration".pid, "uni2-course".cid, "uni2-course".course FROM "university"."uni2-registration", "university"."uni2-course" WHERE "uni2-registration".cid = "uni2-course".cid\n]]\n')])])]),s("p",[t._v("Now we can execute the following SPARQL query on Ontop:")]),t._v(" "),s("div",{staticClass:"language-sparql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sparql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PREFIX")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[s("span",{pre:!0,attrs:{class:"token prefix"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")])])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token url"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("http://example.org/voc#"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PREFIX")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[s("span",{pre:!0,attrs:{class:"token prefix"}},[t._v("foaf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")])])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token url"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("http://xmlns.com/foaf/0.1/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("?course")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("?firstName")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("?lastName")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("?student")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[s("span",{pre:!0,attrs:{class:"token prefix"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")])]),s("span",{pre:!0,attrs:{class:"token local-name"}},[t._v("attends")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("?course")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("?student")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[s("span",{pre:!0,attrs:{class:"token prefix"}},[t._v("foaf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")])]),s("span",{pre:!0,attrs:{class:"token local-name"}},[t._v("firstName")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("?firstName")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("?student")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[s("span",{pre:!0,attrs:{class:"token prefix"}},[t._v("foaf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")])]),s("span",{pre:!0,attrs:{class:"token local-name"}},[t._v("lastName")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("?lastName")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);