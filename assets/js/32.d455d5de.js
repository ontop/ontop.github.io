(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{408:function(t,e,s){"use strict";s.r(e);var a=s(51),r=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"query-logging"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#query-logging"}},[t._v("#")]),t._v(" Query logging")]),t._v(" "),s("p",[s("em",[t._v("Since 4.1.0.")])]),t._v(" "),s("p",[t._v("Query logging, disabled by default, prints one-line JSON objects into the standard output.")]),t._v(" "),s("p",[t._v("Its JSON format follows some ElasticSearch conventions and works nicely with the corresponding stack (FileBeat, ES, Kibana).")]),t._v(" "),s("h2",{attrs:{id:"example"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[t._v("#")]),t._v(" Example")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"@timestamp"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2023-10-13T14:02:05.973Z"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"message"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"query:all"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"application"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ontop-odh"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"payload"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"queryId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"36ade6c6-f091-4af2-9828-ee6316e191f4"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"classesUsedInQuery"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://schema.org/Hotel"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"propertiesUsedInQuery"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://schema.org/name"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"tables"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\"v_accommodationsopen\\""')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"reformulationDuration"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"reformulationCacheHit"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"user"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"joe"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"groups"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"admins,users"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"roles"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my_app_write,my_app_reader"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"httpHeaders"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"referer"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost:8080/"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"extractedQueryTemplate"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"de167012e1ce3cf9dce66a986a3343d883a1f319f800132565b614498d9c73d8"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"parameters"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"v0"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\"Residence Tuberis\\""')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"sparqlQuery"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PREFIX schema: <http://schema.org/>\\nSELECT * WHERE {\\n  ?h a schema:Hotel ; schema:name ?name .\\n  FILTER (langMatches(lang(?name), \'en\'))\\n  FILTER(str(?name) = \\"Residence Tuberis\\")\\n} \\nLIMIT 10"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"reformulatedQuery"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ans1(h,name)\\nCONSTRUCT [h, name] [name/\\"Residence Tuberis\\"^^@en, h/RDF(http://noi.example.org/data/accommodation/{}(VARCHARToTEXT(Id1m148)),IRI)]\\n   NATIVE [Id1m148]\\nSELECT v1.\\"Id\\" AS \\"Id1m148\\"\\nFROM \\"v_accommodationsopen\\" v1\\nWHERE (\'Residence Tuberis\' = v1.\\"AccoDetail-en-Name\\" AND \'HotelPension\' = v1.\\"AccoTypeId\\")\\nLIMIT 10\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"executionBeforeUnblockingDuration"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"executionAndFetchingDuration"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"totalDuration"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"resultCount"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"entries"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#entries"}},[t._v("#")]),t._v(" Entries")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("Key")]),t._v(" "),s("th",[t._v("Type")]),t._v(" "),s("th",[t._v("Description")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("@timestamp")])]),t._v(" "),s("td",[t._v("Timestamp")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[s("code",[t._v("message")])]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("Type of the message. It always start with the prefix "),s("code",[t._v("query:")]),t._v(". Its default value is "),s("code",[t._v("query:all")]),t._v(". In case of an exception, the value starts with "),s("code",[t._v("query:exception-")]),t._v(".")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("application")])]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("Controlled by the property "),s("code",[t._v("ontop.applicationName")]),t._v(".")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("payload")])]),t._v(" "),s("td",[t._v("JSON object")]),t._v(" "),s("td",[t._v("Gathers the entries below.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("queryId")])]),t._v(" "),s("td",[t._v("UUID")]),t._v(" "),s("td",[t._v("Unique to each query.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("classesUsedInQuery")])]),t._v(" "),s("td",[t._v("Array of IRIs")]),t._v(" "),s("td",[t._v("IRIs of the classes appearing in the SPARQL query.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("propertiesUsedInQuery")])]),t._v(" "),s("td",[t._v("Array of IRIs")]),t._v(" "),s("td",[t._v("IRIs of the properties appearing in the SPARQL query.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("tables")])]),t._v(" "),s("td",[t._v("Array of Strings")]),t._v(" "),s("td",[t._v("Names of the relations appearing in the SQL query.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("reformulationDuration")])]),t._v(" "),s("td",[t._v("Integer")]),t._v(" "),s("td",[t._v("Query reformulation duration (in ms).")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("reformulationCacheHit")])]),t._v(" "),s("td",[t._v("Boolean")]),t._v(" "),s("td",[t._v("True if the reformulated query cache has been used")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("user")])]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("Since 5.2.0. User ID. Disabled by default")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("groups")])]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("Since 5.2.0. User groups separated by commas. Disabled by default")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("roles")])]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("Since 5.2.0. User roles separated by commas. Disabled by default")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("httpHeaders")])]),t._v(" "),s("td",[t._v("JSON object")]),t._v(" "),s("td",[t._v("Values of a specific list of HTTP headers. By default, this list is empty. To track for instance the referer, set the property "),s("code",[t._v("ontop.queryLogging.includeHttpHeader.referer")]),t._v(" to true.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("extractedQueryTemplate.")]),t._v(" "),s("code",[t._v("hash")])]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("Hash of the query template extracted, after removing extracted constants. Can be shared by similar queries.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("extractedQueryTemplate.")]),t._v(" "),s("code",[t._v("parameters")])]),t._v(" "),s("td",[t._v("JSON object")]),t._v(" "),s("td",[t._v("Constants extracted and replaced by variables.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("sparqlQuery")])]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("SPARQL query.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("reformulatedQuery")])]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("Includes the SQL query and the post-processing.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("executionBefore")]),t._v(" "),s("code",[t._v("UnblockingDuration")])]),t._v(" "),s("td",[t._v("Integer")]),t._v(" "),s("td",[t._v("Duration between the moments where the SQL query is sent and the result set is unblocked (in ms).")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("executionAndFetching")]),t._v(" "),s("code",[t._v("Duration")])]),t._v(" "),s("td",[t._v("Integer")]),t._v(" "),s("td",[t._v("Duration between the moments where the SQL query is sent and the last result is fetched (in ms).")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("totalDuration")])]),t._v(" "),s("td",[t._v("Integer")]),t._v(" "),s("td",[t._v("Total duration (in ms).")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("resultCount")])]),t._v(" "),s("td",[t._v("Integer")]),t._v(" "),s("td",[t._v("Number of results returned.")])])])]),t._v(" "),s("h2",{attrs:{id:"default-settings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#default-settings"}},[t._v("#")]),t._v(" Default settings")]),t._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Query logging is disabled by default")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ontop.queryLogging")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("false")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Application name (needed for logging)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ontop.applicationName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("Ontop")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Includes the SPARQL query string into the query log")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ontop.queryLogging.includeSparqlQuery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Includes the reformulated query into the query log")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ontop.queryLogging.includeReformulatedQuery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("false")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Includes classes and properties into the query log")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ontop.queryLogging.includeClassesAndProperties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Includes DB tables/views into the query log")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ontop.queryLogging.includeTables")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Includes the user ID, his/her groups and roles")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ontop.queryLogging.includeUserInfo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("false")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Provides separated message at different phases (after reformulation, result set unblocked, last result fetched)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ontop.queryLogging.decomposition")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("false")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Sets that merged messages are only inserted when decomposition is disabled")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ontop.queryLogging.decompositionAndMergingMutuallyExclusive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);