<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Support a new database system | Ontop</title>
    <meta name="generator" content="VuePress 1.8.2">
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.2b9f24ec.css" as="style"><link rel="preload" href="/assets/js/app.eb43982a.js" as="script"><link rel="preload" href="/assets/js/2.ce8d9015.js" as="script"><link rel="preload" href="/assets/js/19.c55473af.js" as="script"><link rel="prefetch" href="/assets/js/10.68331741.js"><link rel="prefetch" href="/assets/js/100.a1623fb3.js"><link rel="prefetch" href="/assets/js/101.9ab7aec6.js"><link rel="prefetch" href="/assets/js/11.db065c65.js"><link rel="prefetch" href="/assets/js/12.6ee50bb8.js"><link rel="prefetch" href="/assets/js/13.82c8b4b6.js"><link rel="prefetch" href="/assets/js/14.7d837e4f.js"><link rel="prefetch" href="/assets/js/15.772deb9e.js"><link rel="prefetch" href="/assets/js/16.62e1cbcc.js"><link rel="prefetch" href="/assets/js/17.77563a30.js"><link rel="prefetch" href="/assets/js/18.fd0e0bcf.js"><link rel="prefetch" href="/assets/js/20.8c67cb7d.js"><link rel="prefetch" href="/assets/js/21.86f0abbe.js"><link rel="prefetch" href="/assets/js/22.414c31d0.js"><link rel="prefetch" href="/assets/js/23.cf6bf106.js"><link rel="prefetch" href="/assets/js/24.1b65c2ca.js"><link rel="prefetch" href="/assets/js/25.a81fcff6.js"><link rel="prefetch" href="/assets/js/26.f2aa70fe.js"><link rel="prefetch" href="/assets/js/27.906526eb.js"><link rel="prefetch" href="/assets/js/28.4cee7768.js"><link rel="prefetch" href="/assets/js/29.6957445c.js"><link rel="prefetch" href="/assets/js/3.b2b12655.js"><link rel="prefetch" href="/assets/js/30.a3858dfb.js"><link rel="prefetch" href="/assets/js/31.61f19771.js"><link rel="prefetch" href="/assets/js/32.6d755852.js"><link rel="prefetch" href="/assets/js/33.50424873.js"><link rel="prefetch" href="/assets/js/34.538b1329.js"><link rel="prefetch" href="/assets/js/35.84a1a3b4.js"><link rel="prefetch" href="/assets/js/36.5bdc37ce.js"><link rel="prefetch" href="/assets/js/37.fa71704e.js"><link rel="prefetch" href="/assets/js/38.72435b1c.js"><link rel="prefetch" href="/assets/js/39.7273a57f.js"><link rel="prefetch" href="/assets/js/4.a66f962f.js"><link rel="prefetch" href="/assets/js/40.b98105be.js"><link rel="prefetch" href="/assets/js/41.a6eb7ce1.js"><link rel="prefetch" href="/assets/js/42.7ab01a81.js"><link rel="prefetch" href="/assets/js/43.2d74ecb3.js"><link rel="prefetch" href="/assets/js/44.e4a1f226.js"><link rel="prefetch" href="/assets/js/45.9701864a.js"><link rel="prefetch" href="/assets/js/46.14bdc711.js"><link rel="prefetch" href="/assets/js/47.79e4c038.js"><link rel="prefetch" href="/assets/js/48.c356711b.js"><link rel="prefetch" href="/assets/js/49.1e42a7ad.js"><link rel="prefetch" href="/assets/js/5.e8e9de00.js"><link rel="prefetch" href="/assets/js/50.5acb2547.js"><link rel="prefetch" href="/assets/js/51.ee161644.js"><link rel="prefetch" href="/assets/js/52.24b98f0a.js"><link rel="prefetch" href="/assets/js/53.a3b36b6b.js"><link rel="prefetch" href="/assets/js/54.dd559dbb.js"><link rel="prefetch" href="/assets/js/55.6822d82c.js"><link rel="prefetch" href="/assets/js/56.f0c527ce.js"><link rel="prefetch" href="/assets/js/57.99869b38.js"><link rel="prefetch" href="/assets/js/58.5a927cba.js"><link rel="prefetch" href="/assets/js/59.01f91d11.js"><link rel="prefetch" href="/assets/js/6.e48edabd.js"><link rel="prefetch" href="/assets/js/60.9f0df2c5.js"><link rel="prefetch" href="/assets/js/61.521e2d39.js"><link rel="prefetch" href="/assets/js/62.f54f0015.js"><link rel="prefetch" href="/assets/js/63.6009b242.js"><link rel="prefetch" href="/assets/js/64.bd5861d7.js"><link rel="prefetch" href="/assets/js/65.0e7618e9.js"><link rel="prefetch" href="/assets/js/66.1c9994cb.js"><link rel="prefetch" href="/assets/js/67.34456368.js"><link rel="prefetch" href="/assets/js/68.9ed50067.js"><link rel="prefetch" href="/assets/js/69.bd14a16e.js"><link rel="prefetch" href="/assets/js/7.ee7e5098.js"><link rel="prefetch" href="/assets/js/70.5fa5580d.js"><link rel="prefetch" href="/assets/js/71.fa5732fb.js"><link rel="prefetch" href="/assets/js/72.2194f65f.js"><link rel="prefetch" href="/assets/js/73.4ecb580d.js"><link rel="prefetch" href="/assets/js/74.a90602c7.js"><link rel="prefetch" href="/assets/js/75.31a94859.js"><link rel="prefetch" href="/assets/js/76.38ade3e0.js"><link rel="prefetch" href="/assets/js/77.9e873189.js"><link rel="prefetch" href="/assets/js/78.56d3fb51.js"><link rel="prefetch" href="/assets/js/79.2b4ef530.js"><link rel="prefetch" href="/assets/js/8.a24e3ea0.js"><link rel="prefetch" href="/assets/js/80.8238f2ff.js"><link rel="prefetch" href="/assets/js/81.9dfe4a48.js"><link rel="prefetch" href="/assets/js/82.63936fdc.js"><link rel="prefetch" href="/assets/js/83.9257a559.js"><link rel="prefetch" href="/assets/js/84.047a878e.js"><link rel="prefetch" href="/assets/js/85.38f8dbbf.js"><link rel="prefetch" href="/assets/js/86.152dc3a8.js"><link rel="prefetch" href="/assets/js/87.4e3c3b2f.js"><link rel="prefetch" href="/assets/js/88.f071f358.js"><link rel="prefetch" href="/assets/js/89.9d959d6c.js"><link rel="prefetch" href="/assets/js/9.2397fef4.js"><link rel="prefetch" href="/assets/js/90.bcdd4630.js"><link rel="prefetch" href="/assets/js/91.896066a6.js"><link rel="prefetch" href="/assets/js/92.c65778d4.js"><link rel="prefetch" href="/assets/js/93.6d3a4f71.js"><link rel="prefetch" href="/assets/js/94.7185c4f4.js"><link rel="prefetch" href="/assets/js/95.49f8a9b5.js"><link rel="prefetch" href="/assets/js/96.def7d709.js"><link rel="prefetch" href="/assets/js/97.304c61e4.js"><link rel="prefetch" href="/assets/js/98.157c3f60.js"><link rel="prefetch" href="/assets/js/99.ba5b9a3e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2b9f24ec.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Ontop</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/tutorial/" class="nav-link">
  Tutorial
</a></div><div class="nav-item"><a href="/download/" class="nav-link">
  Download
</a></div><div class="nav-item"><a href="/community/" class="nav-link">
  Community
</a></div><div class="nav-item"><a href="/research/" class="nav-link">
  Research
</a></div><div class="nav-item"><a href="/dev/" class="nav-link router-link-active">
  Dev
</a></div><div class="nav-item"><a href="/jobs/" class="nav-link">
  Work with us
</a></div> <a href="https://github.com/ontop/ontop" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/tutorial/" class="nav-link">
  Tutorial
</a></div><div class="nav-item"><a href="/download/" class="nav-link">
  Download
</a></div><div class="nav-item"><a href="/community/" class="nav-link">
  Community
</a></div><div class="nav-item"><a href="/research/" class="nav-link">
  Research
</a></div><div class="nav-item"><a href="/dev/" class="nav-link router-link-active">
  Dev
</a></div><div class="nav-item"><a href="/jobs/" class="nav-link">
  Work with us
</a></div> <a href="https://github.com/ontop/ontop" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Development</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/" aria-current="page" class="sidebar-link">Overview</a></li><li><a href="/dev/git.html" class="sidebar-link">Git workflow</a></li><li><a href="/dev/build.html" class="sidebar-link">Build Ontop Bundles</a></li><li><a href="/dev/new-release.html" class="sidebar-link">Make a new release</a></li><li><a href="/dev/debug-protege.html" class="sidebar-link">Debug Protégé</a></li><li><a href="/dev/debug-jetty.html" class="sidebar-link">Debug Jetty</a></li><li><a href="/dev/db-adapter.html" aria-current="page" class="active sidebar-link">Support a new database system</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/db-adapter.html#required-implementations" class="sidebar-link">Required implementations</a></li><li class="sidebar-sub-header"><a href="/dev/db-adapter.html#optional-implementations" class="sidebar-link">Optional implementations</a></li><li class="sidebar-sub-header"><a href="/dev/db-adapter.html#declaring-an-implementation" class="sidebar-link">Declaring an implementation</a></li><li class="sidebar-sub-header"><a href="/dev/db-adapter.html#preparing-and-running-the-testcases" class="sidebar-link">Preparing and Running the Testcases</a></li><li class="sidebar-sub-header"><a href="/dev/db-adapter.html#further-implementations-and-troubleshooting" class="sidebar-link">Further Implementations and Troubleshooting</a></li></ul></li><li><a href="/dev/stats.html" class="sidebar-link">Statistics</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Internals</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/internals/iq.html" class="sidebar-link">Intermediate Query (IQ)</a></li><li><a href="/dev/internals/guice.html" class="sidebar-link">Guice Conventions</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Outdated corner</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="support-a-new-database-system"><a href="#support-a-new-database-system" class="header-anchor">#</a> Support a new database system</h1> <p>This page describes how Ontop can be extended to support a novel relational database system (RDBMS).</p> <p>The following RDBMSs are currently supported:</p> <ul><li>DB2</li> <li>MySQL / MariaDB</li> <li>Oracle</li> <li>PostgreSQL</li> <li>SQL server</li> <li>H2</li> <li>Denodo</li> <li>Dremio</li> <li>Apache Spark SQL &amp; Databricks</li> <li>Teiid</li> <li>Snowflake</li> <li>Trino</li> <li>Presto</li> <li>Athena</li> <li>Redshift</li> <li>DuckDB</li></ul> <p>It is relatively easy though to extend Ontop's source code in order to support an additional RDBMS, thanks to dependency injection.</p> <div class="custom-block tip"><p class="custom-block-title">New: Guided Implementation</p> <p>Ontop also provides a <a href="https://github.com/ontop/dialect-factory-scaffolding" target="_blank" rel="noopener">python tool<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> that automatically generates a large part of the required code end simplifies the process of developing support for new SQL dialects.</p> <p>Using it minimizes the overhead for the implementation of new dialect support and allows you to test your code easily right away.</p></div> <p><em>This page provides a detailed explanation of the key concepts that need to be implemented, and was updated with Ontop 5.0.2. For newer versions of Ontop, it may no longer be up-to-date.</em></p> <h2 id="required-implementations"><a href="#required-implementations" class="header-anchor">#</a> Required implementations</h2> <p>Two implementations must be provided, each for a different interface that already has a default (abstract) implementation.</p> <p>These implementations dictate what the datatypes of the RDBMS are and how certain function symbols can be translated into the SQL dialect supported by the RDBMS.</p> <p>The default implementation of each of these interfaces is often sufficient to handle many query operators and functions.  As a result, only a few methods generally need to be overwritten,
to account for specificities of the new SQL dialect.</p> <p>The 2 required implementations are the DB function symbol factory and the DB datatype factory.</p> <h3 id="db-function-symbol-factory"><a href="#db-function-symbol-factory" class="header-anchor">#</a> DB function symbol factory</h3> <p>The <em>DB function symbol factory</em> provides function symbols
which can be directly serialized into the target SQL dialect (e.g. <code>LENGTH</code> or <code>CURRENT_TIMESTAMP</code>). This factory has methods for common operations with precise semantics (e.g. concatenating 3 string arguments in a null-rejecting manner).</p> <p>The interface to implement is <code>DBFunctionSymbolFactory</code>.<br>
And the default implementation is <code>AbstractSQLDBFunctionSymbolFactory</code>.</p> <p>For instance, the DB function symbol factory for PostgreSQL within Ontop is the class <code>PostgreSQLDBFunctionSymbolFactory</code>.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>This interface should not be confused with the <code>FunctionSymbolFactory</code>, which is in charge of constructing
SPARQL function symbols and other function symbols that cannot be directly serialized into SQL.</p></div> <p>A basic template for this implementation is provided here:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NewDialectDBFunctionSymbolFactory</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractSQLDBFunctionSymbolFactory</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Inject</span>
    <span class="token keyword">protected</span> <span class="token class-name">DuckDBDBFunctionSymbolFactory</span><span class="token punctuation">(</span><span class="token class-name">TypeFactory</span> typeFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token function">createNewDialectRegularFunctionTable</span><span class="token punctuation">(</span>typeFactory<span class="token punctuation">)</span><span class="token punctuation">,</span> typeFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token class-name">ImmutableTable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">DBFunctionSymbol</span><span class="token punctuation">&gt;</span></span> <span class="token function">createNewDialectRegularFunctionTable</span><span class="token punctuation">(</span><span class="token class-name">TypeFactory</span> typeFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DBTypeFactory</span> dbTypeFactory <span class="token operator">=</span> typeFactory<span class="token punctuation">.</span><span class="token function">getDBTypeFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DBTermType</span> abstractRootDBType <span class="token operator">=</span> dbTypeFactory<span class="token punctuation">.</span><span class="token function">getAbstractRootDBType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Table</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">DBFunctionSymbol</span><span class="token punctuation">&gt;</span></span> table <span class="token operator">=</span> <span class="token class-name">HashBasedTable</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                <span class="token function">createDefaultRegularFunctionTable</span><span class="token punctuation">(</span>typeFactory<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/*
            ------------------------------------------
            -       Changed Function Symbols         -
            ------------------------------------------
        */</span>
        <span class="token keyword">return</span> <span class="token class-name">ImmutableTable</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/*
        ------------------------------------------
        -             Implementations            -
        ------------------------------------------
    */</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In the template above, two code blocks are commented out. We will now look at each of them individually.</p> <h4 id="changed-function-symbols"><a href="#changed-function-symbols" class="header-anchor">#</a> <strong>Changed Function Symbols</strong></h4> <p>The <em>regular function table</em> is a dictionary, that maps from function names to the function symbol instance it corresponds to. The abstract base classes we inherit from already define a default function symbol table that includes all commonly used SQL functions. In some cases, however, some of these default function symbols need to be changed. For these cases, new entries can be created in this block, to override existing, bad entries.</p> <p>A popular example is the <code>CURRENT_TIMESTAMP</code> function symbol. By default, it is created as a simple function with arity 0 of the form <code>CURRENT_TIMESTAMP()</code>. In some dialects, however, the current time is called without parentheses, simply in the form <code>CURRENT_TIMESTAMP</code>. In this case, we need to override the function symbol created by the default implementation, to not include parentheses:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">DBFunctionSymbol</span> nowFunctionSymbol <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WithoutParenthesesSimpleTypedDBFunctionSymbolImpl</span><span class="token punctuation">(</span>
    CURRENT_TIMESTAMP_STR<span class="token punctuation">,</span> dbTypeFactory<span class="token punctuation">.</span><span class="token function">getDBDateTimestampType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> abstractRootDBType<span class="token punctuation">)</span><span class="token punctuation">;</span>
table<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>CURRENT_TIMESTAMP_STR<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> nowFunctionSymbol<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>CURRENT_TIMESTAMP</code> function is now a <code>WithoutParenthesesSimpleTypedDBFunctionSymbol</code>, so when generating SQL queries, ontop will not include the parentheses. By putting this new function symbol into the table at the key <code>CURRENT_TIMESTAMP_STR</code>, we override the default behaviour that was put into the table by the default method.</p> <h4 id="implementations"><a href="#implementations" class="header-anchor">#</a> <strong>Implementations</strong></h4> <p>A set of serialization methods have been left abstract by the base classes. These <em>always</em> have to be implemented for each new dialect.</p> <p>All such methods share the same structure:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">String</span> serialize<span class="token punctuation">[</span>FUNCTION_NAME<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token class-name">ImmutableList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">ImmutableTerm</span><span class="token punctuation">&gt;</span></span> terms<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImmutableTerm</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> termConverter<span class="token punctuation">,</span> <span class="token class-name">TermFactory</span> termFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Here, <code>terms</code> is the list of arguments that were passed to the function, <code>termConverter</code> ist a function that can be used to transform any given term into its SQL equivalent, and termFactory can be used to generate new terms that may be required for some functions.</p> <p>We will now go through each of them and provide example implementations.</p> <p><em><strong>Contains</strong></em>:</p> <p>This function returns a boolean value, indicating whether a given string (argument 2) is included in a different string (argument 1). While some dialects have their own <code>CONTAINS</code> functions, for others it may have to be implemented through a string search, like in this example:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">serializeContains</span><span class="token punctuation">(</span><span class="token class-name">ImmutableList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">ImmutableTerm</span><span class="token punctuation">&gt;</span></span> terms<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImmutableTerm</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> termConverter<span class="token punctuation">,</span> <span class="token class-name">TermFactory</span> termFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;(POSITION(%s IN %s) &gt; 0)&quot;</span><span class="token punctuation">,</span>
                            termConverter<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>terms<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            termConverter<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>terms<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><em><strong>StrBefore</strong></em>:</p> <p>This function returns the section of a given string (argument 1) before the first appearance of a given search string (argument 2). If the searched string is not contained in the base string, an empty string is returned instead. In many languages, this can be implemented using string search and substring methods.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">serializeStrBefore</span><span class="token punctuation">(</span><span class="token class-name">ImmutableList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">ImmutableTerm</span><span class="token punctuation">&gt;</span></span> terms<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImmutableTerm</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> termConverter<span class="token punctuation">,</span> <span class="token class-name">TermFactory</span> termFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> str <span class="token operator">=</span> termConverter<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>terms<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> before <span class="token operator">=</span> termConverter<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>terms<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;SUBSTRING(%s,1,POSITION(%s IN %s)-1)&quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> before<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><em><strong>StrAfter</strong></em>:</p> <p>The opposite of <code>STRBEFORE</code>, this function returns the section of a given string (argument 1) <em>after</em> the first appearance of a search string (argument 2). This function can be implemented similarly:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">serializeStrBefore</span><span class="token punctuation">(</span><span class="token class-name">ImmutableList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">ImmutableTerm</span><span class="token punctuation">&gt;</span></span> terms<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImmutableTerm</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> termConverter<span class="token punctuation">,</span> <span class="token class-name">TermFactory</span> termFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> str <span class="token operator">=</span> termConverter<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>terms<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> before <span class="token operator">=</span> termConverter<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>terms<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;SUBSTRING(%s, IF(POSITION(%s IN %s) != 0, POSITION(%s IN %s) + LENGTH(%s), 0))&quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> after<span class="token punctuation">,</span> str<span class="token punctuation">,</span> after<span class="token punctuation">,</span> str<span class="token punctuation">,</span> after<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><em><strong>Tz</strong></em>:
This function extracts the timezone part of a given timestamp. An example implementation may look like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">serializeTz</span><span class="token punctuation">(</span><span class="token class-name">ImmutableList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">ImmutableTerm</span><span class="token punctuation">&gt;</span></span> terms<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImmutableTerm</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> termConverter<span class="token punctuation">,</span> <span class="token class-name">TermFactory</span> termFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> str <span class="token operator">=</span> termConverter<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>terms<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;(LPAD(EXTRACT(TIMEZONE_HOUR FROM %s)::text,2,'0') || ':' || LPAD(EXTRACT(TIMEZONE_MINUTE FROM %s)::text,2,'0'))&quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><em><strong>DateTimeNorm</strong></em>:
This function converts a given timestamp to the standardized <code>ISO 8601</code> format. An example implementation may look like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">serializeDateTimeNorm</span><span class="token punctuation">(</span><span class="token class-name">ImmutableList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">ImmutableTerm</span><span class="token punctuation">&gt;</span></span> terms<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImmutableTerm</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> termConverter<span class="token punctuation">,</span> <span class="token class-name">TermFactory</span> termFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;TO_ISO8601(%s)&quot;</span><span class="token punctuation">,</span> termConverter<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>terms<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><em><strong>Hashing Functions</strong></em>:</p> <p>Ontop supports a set of hasing functions:</p> <ul><li><code>MD5</code></li> <li><code>SHA1</code></li> <li><code>SHA256</code></li> <li><code>SHA384</code></li> <li><code>SHA512</code></li></ul> <p>For each of them, the implementation of a serialization method is required. An example implementation of the <code>MD5</code> function may look like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">serializeMD5</span><span class="token punctuation">(</span><span class="token class-name">ImmutableList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">ImmutableTerm</span><span class="token punctuation">&gt;</span></span> terms<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImmutableTerm</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> termConverter<span class="token punctuation">,</span> <span class="token class-name">TermFactory</span> termFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;MD5(%s)&quot;</span><span class="token punctuation">,</span> termConverter<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>terms<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p></p> <p>Other than the serialization methods, four additional methods must be implemented by the subclass:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">getUUIDNameInDialect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">&quot;[UUID_FUNCTION_NAME]&quot;</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><p>returns the string that represents the name of the UUID in the SQL dialect.</p> <p>The methods <code>createNullRejectingDBConcat(int arity)</code>, <code>createDBConcatOperator(int arity)</code>, and <code>createRegularDBConcat(int arity)</code> need to be implemented to define the concat function symbols. The <code>DBConcat</code> methods define function symbols that represent <code>CONCAT</code> function calls of a given arity. Sample implementations for them may look like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token class-name">DBConcatFunctionSymbol</span> <span class="token function">createRegularDBConcat</span><span class="token punctuation">(</span><span class="token keyword">int</span> arity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">NullToleratingDBConcatFunctionSymbol</span><span class="token punctuation">(</span><span class="token string">&quot;CONCAT&quot;</span><span class="token punctuation">,</span> arity<span class="token punctuation">,</span> dbStringType<span class="token punctuation">,</span> abstractRootDBType<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token class-name">DBConcatFunctionSymbol</span> <span class="token function">createNullRejectingDBConcat</span><span class="token punctuation">(</span><span class="token keyword">int</span> arity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">NullRejectingDBConcatFunctionSymbol</span><span class="token punctuation">(</span><span class="token string">&quot;CONCAT_NO_NULL&quot;</span><span class="token punctuation">,</span> arity<span class="token punctuation">,</span> dbStringType<span class="token punctuation">,</span> abstractRootDBType<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>createDBConcatOperator(int arity)</code> method represents a concat operation executed through a concat operator (often <code>+</code> or <code>||</code>). It may be implemented like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token class-name">DBConcatFunctionSymbol</span> <span class="token function">createDBConcatOperator</span><span class="token punctuation">(</span><span class="token keyword">int</span> arity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">NullRejectingDBConcatFunctionSymbol</span><span class="token punctuation">(</span><span class="token string">&quot;||&quot;</span><span class="token punctuation">,</span> arity<span class="token punctuation">,</span> dbStringType<span class="token punctuation">,</span> abstractRootDBType<span class="token punctuation">,</span> <span class="token class-name">Serializers</span><span class="token punctuation">.</span><span class="token function">getOperatorSerializer</span><span class="token punctuation">(</span><span class="token string">&quot;||&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="db-datatype-factory"><a href="#db-datatype-factory" class="header-anchor">#</a> DB Datatype factory</h3> <p>The <em>DB datatype factory</em> declares the hierarchy of DB datatypes used by the DBMS, and specifies their correspondence with datatypes used in the RDF graphs (such as xsd datatypes).</p> <p>The interface to implement (for SQL dialects) is <code>SQLDBTypeFactory</code>.<br>
And the default implementation is <code>DefaultSQLDBTypeFactory</code> .</p> <p>For instance, the datatype factory for PostgreSQL within Ontop is the class <code>PostgreSQLDBTypeFactory</code>.</p> <p>A basic template for this implementation is provided here:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NewDialectDBTypeFactory</span> <span class="token keyword">extends</span> <span class="token class-name">DefaultSQLDBTypeFactory</span> <span class="token punctuation">{</span>
    <span class="token comment">/*
        ------------------------------------------
        -             Type Definitions           -
        ------------------------------------------
    */</span>
    <span class="token annotation punctuation">@AssistedInject</span>
    <span class="token keyword">protected</span> <span class="token class-name">NewDialectDBTypeFactory</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Assisted</span> <span class="token class-name">TermType</span> rootTermType<span class="token punctuation">,</span> <span class="token annotation punctuation">@Assisted</span> <span class="token class-name">TypeFactory</span> typeFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token function">createNewDialectTypeMap</span><span class="token punctuation">(</span>rootTermType<span class="token punctuation">,</span> typeFactory<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">createNewDialectCodeMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">DBTermType</span><span class="token punctuation">&gt;</span></span> <span class="token function">createNewDialectTypeMap</span><span class="token punctuation">(</span><span class="token class-name">TermType</span> rootTermType<span class="token punctuation">,</span> <span class="token class-name">TypeFactory</span> typeFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/*
            ------------------------------------------
            -                Type Map                -
            ------------------------------------------
        */</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token class-name">ImmutableMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DefaultTypeCode</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">createNewDialectCodeMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/*
            ------------------------------------------
            -               Code Map                -
            ------------------------------------------
        */</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/*
        ------------------------------------------
        -             Support Flags              -
        ------------------------------------------
    */</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In the template above, four code blocks are commented out. We will now look at each of them individually.</p> <h4 id="type-definitions"><a href="#type-definitions" class="header-anchor">#</a> <strong>Type Definitions</strong></h4> <p>In this section, we define a set of <code>String</code> constants that represent the names of datatypes in our SQL dialect. These constants are then used in other code blocks. An excerpt of the <em>type definitions</em> part in an implementation may look like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> BIT_STR <span class="token operator">=</span> <span class="token string">&quot;BIT&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> INT2_STR <span class="token operator">=</span> <span class="token string">&quot;INT2&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> INT4_STR <span class="token operator">=</span> <span class="token string">&quot;INT4&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> INT8_STR <span class="token operator">=</span> <span class="token string">&quot;INT8&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> FLOAT4_STR <span class="token operator">=</span> <span class="token string">&quot;FLOAT4&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> FLOAT8_STR <span class="token operator">=</span> <span class="token string">&quot;FLOAT8&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="type-map"><a href="#type-map" class="header-anchor">#</a> <strong>TYPE MAP</strong></h4> <p>In this method, we define the contents of the type map for our dialect. We create <code>DBTermType</code> instances for each supported type and store them in a <code>Map</code> object, that matches their identifiers to the <code>DBTermType</code>. The base class we extend from already generates an extensive type map for many popular types, such as <code>VARCHAR</code>, <code>INTEGER</code>, <code>REAL</code>, <code>DOUBLE</code>, and more in the method <code>createDefaultSQLTypeMap(...)</code>.  New types can be added to the map in the subclass, and, alternatively, we can override existing entries in the map here. An example implementation of this method may look like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">DBTermType</span><span class="token punctuation">&gt;</span></span> <span class="token function">createNewDialectTypeMap</span><span class="token punctuation">(</span><span class="token class-name">TermType</span> rootTermType<span class="token punctuation">,</span> <span class="token class-name">TypeFactory</span> typeFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">TermTypeAncestry</span> rootAncestry <span class="token operator">=</span> rootTermType<span class="token punctuation">.</span><span class="token function">getAncestry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">DBTermType</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token function">createDefaultSQLTypeMap</span><span class="token punctuation">(</span>rootTermType<span class="token punctuation">,</span> typeFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> map<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="code-map"><a href="#code-map" class="header-anchor">#</a> <strong>CODE MAP</strong></h4> <p>The code map is a dictionary, that maps different type codes to their &quot;default type&quot; for the SQL dialect. This includes the following type codes:</p> <ul><li><code>STRING</code></li> <li><code>HEXBINARY</code></li> <li><code>LARGE_INTEGER</code></li> <li><code>DECIMAL</code></li> <li><code>DOUBLE</code></li> <li><code>BOOLEAN</code></li> <li><code>DATE</code></li> <li><code>TIME</code></li> <li><code>DATETIMESTAMP</code></li> <li><code>GEOMETRY</code></li> <li><code>GEOGRAPHY</code></li> <li><code>ARRAY</code></li> <li><code>JSON</code></li></ul> <p>The default implementation already maps many of these to the name of the corresponding data type. To support additional ones, or to override existing mappings, this method can be implemented. An example implementation may look like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token class-name">ImmutableMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DefaultTypeCode</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">createNewDialectCodeMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DefaultTypeCode</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token function">createDefaultSQLCodeMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">DefaultTypeCode</span><span class="token punctuation">.</span>JSON<span class="token punctuation">,</span> JSONB_STR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ImmutableMap</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="support-flags"><a href="#support-flags" class="header-anchor">#</a> <strong>Support Flags</strong></h4> <p>An instance of <code>DBTypeFactory</code> supports a set of methods that, when called, return a flag indicating if a certain SQL feature is supported by the dialect. These methods are</p> <ul><li><code>supportsDBGeometryType()</code></li> <li><code>supportsDBGeographyType()</code></li> <li><code>supportsDBDistanceSphere()</code></li> <li><code>supportsJson()</code></li> <li><code>supportsArrayType()</code></li></ul> <p>Any of these functions can be overridden by the <code>DBTypeFactory</code> sub-class to return a boolean constant indicating if the type is supported.</p> <h4 id="other-implementations"><a href="#other-implementations" class="header-anchor">#</a> <strong>Other Implementations</strong></h4> <p>The <code>DBTypeFactory</code> base-class supports further methods that can be included in sub-classes for fine-tuning. One popular set of such methods are the <code>LexicalValue</code> methods. These return a <code>String</code> constant that represents the lexical value the corresponding literal may assume. For instance, by default, the method <code>getDBFalseLexicalValue()</code> returns the string <code>&quot;FALSE&quot;</code>, as this is a common representation of the boolean <code>false</code> value in many SQL dialects. To implement the <code>DBTypeFactory</code> for a dialect that instead uses the digit <code>0</code> for <code>false</code> literals, we could override the method like so:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDBFalseLexicalValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="optional-implementations"><a href="#optional-implementations" class="header-anchor">#</a> Optional implementations</h2> <p>Additional implementations can be optionally provided in replacement of the default implementation.</p> <h3 id="serializer"><a href="#serializer" class="header-anchor">#</a> Serializer</h3> <p>The <em>serializer</em> dictates the general shape (SELECT-FROM-WHERE) of the SQL query.</p> <p>The interface to implement is <code>SelectFromWhereSerializer</code>.<br>
And the default implementation is <code>DefaultSelectFromWhereSerializer</code>.</p> <p>For instance, the serializer for PostgreSQL within Ontop is the class <code>PostgresSelectFromWhereSerializer</code>.</p> <h3 id="normalizer"><a href="#normalizer" class="header-anchor">#</a> Normalizer</h3> <p>The <em>normalizer</em> addresses limitations of certain DBMSs (such as a non-canonical evaluation of the ORDER BY clause).</p> <p>The interface to implement is <code>DialectExtraNormalizer</code>.<br>
And several implementations are already available, some of which are used by several DBMS.</p> <p>For instance, the normalizer associated to PostgreSQL within Ontop is <code>OnlyInPresenceOfDistinctProjectOrderByTermsNormalizer</code>.</p> <h3 id="metadata-provider"><a href="#metadata-provider" class="header-anchor">#</a> Metadata provider</h3> <p>The <em>metadata provider</em> specifies how schema and integrity constraints (for instance primary keys) are retrieved from the DBMS.</p> <p>The interface to implement is <code>MetadataProvider</code>.<br>
And the default implementation is <code>DefaultDBMetadataProvider</code>.</p> <p>For instance, the metadata provider for PostgreSQL within Ontop is <code>PostgreSQLDBMetadataProvider</code>.</p> <h2 id="declaring-an-implementation"><a href="#declaring-an-implementation" class="header-anchor">#</a> Declaring an implementation</h2> <p>All the implementations mentioned above can be declared in the property file <code>sql-default.properties</code> (which can be found in the directory <code>it/unibz/inf/ontop/injection/</code> of the <code>ontop-rdb</code> module).</p> <p>A key-value pair must be added for each of these implementations, where the key indicates the type of the implementation (serializer, function symbol factory, etc.), and the value is the implementation.</p> <p>The naming scheme for the keys is the following.<br>
Let <code>&lt;driverName&gt;</code> be the name of the JDBC driver for the RDBMS (for instance, the JDBC driver for PostgreSQL is <code>org.postgresql.Driver</code>.<br>
Then the keys are:</p> <ul><li><code>&lt;driverName&gt;-serializer</code> for a serializer</li> <li><code>&lt;driverName&gt;-symbolFactory</code> for a DB function symbol factory</li> <li><code>&lt;driverName&gt;-typeFactory</code> for a DB datatype factory</li> <li><code>&lt;driverName&gt;-normalizer</code> for a normalizer</li> <li><code>&lt;driverName&gt;-metadataProvider</code> for a metadata provider</li></ul> <p>For instance, the key-value pairs declared for PostgreSQL are:</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">org.postgresql.Driver-serializer</span> <span class="token punctuation">=</span> <span class="token attr-value">it.unibz.inf.ontop.generation.serializer.impl.PostgresSelectFromWhereSerializer</span>
<span class="token attr-name">org.postgresql.Driver-symbolFactory</span> <span class="token punctuation">=</span> <span class="token attr-value">it.unibz.inf.ontop.model.term.functionsymbol.db.impl.PostgreSQLDBFunctionSymbolFactory</span>
<span class="token attr-name">org.postgresql.Driver-typeFactory</span> <span class="token punctuation">=</span> <span class="token attr-value">it.unibz.inf.ontop.model.type.impl.PostgreSQLDBTypeFactory</span>
<span class="token attr-name">org.postgresql.Driver-normalizer</span> <span class="token punctuation">=</span> <span class="token attr-value">it.unibz.inf.ontop.generation.normalization.impl.OnlyInPresenceOfDistinctProjectOrderByTermsNormalizer</span>
<span class="token attr-name">org.postgresql.Driver-metadataProvider</span> <span class="token punctuation">=</span> <span class="token attr-value">it.unibz.inf.ontop.dbschema.impl.PostgreSQLDBMetadataProvider</span>
</code></pre></div><p>A basic set of key-value pairs may be:</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">name.of.jdbc.Driver-serializer</span> <span class="token punctuation">=</span> <span class="token attr-value">it.unibz.inf.ontop.generation.serializer.impl.DefaultSelectFromWhereSerializer</span>
<span class="token attr-name">name.of.jdbc.Driver-symbolFactory</span> <span class="token punctuation">=</span> <span class="token attr-value">it.unibz.inf.ontop.model.term.functionsymbol.db.impl.NewDialectDBFunctionSymbolFactory</span>
<span class="token attr-name">name.of.jdbc.Driver-typeFactory</span> <span class="token punctuation">=</span> <span class="token attr-value">it.unibz.inf.ontop.model.type.impl.NewDialectDBTypeFactory</span>
<span class="token attr-name">name.of.jdbc.Driver-normalizer</span> <span class="token punctuation">=</span> <span class="token attr-value">it.unibz.inf.ontop.generation.normalization.impl.OnlyInPresenceOfDistinctProjectOrderByTermsNormalizer</span>
<span class="token attr-name">name.of.jdbc.Driver-metadataProvider</span> <span class="token punctuation">=</span> <span class="token attr-value">it.unibz.inf.ontop.dbschema.impl.DefaultSchemaCatalogDBMetadataProvider</span>
</code></pre></div><h2 id="preparing-and-running-the-testcases"><a href="#preparing-and-running-the-testcases" class="header-anchor">#</a> Preparing and Running the Testcases</h2> <p>Ontop currently uses a set of tests called <code>lightweight-tests</code> to test all main ontop language support features on minimal databases. A simple way of testing the correctness of newly implemented dialect support is to run the same tests a database that uses the corresponding dialect.</p> <p>This consists of the following steps:</p> <ol><li>Set up a database with the required testing conditions</li> <li>Prepare files that assist the connection to the database</li> <li>Implement sub-classes of the abstract lightweight test classes and run them</li></ol> <p>In the following sections, we will discuss each of these steps.</p> <h3 id="setting-up-the-database"><a href="#setting-up-the-database" class="header-anchor">#</a> Setting up the Database</h3> <p>The exact procedure of the database preparation depends on the database system. In ontop, we generally use docker images that reproduce the exact same database state for each test run so we can test the different dialects automatically.</p> <p>Each directory inside <code>test/lightweight-tests/lightweight-db-test-images/</code> corresponds to one docker image, and many of them contain table definitions in <code>.sql</code> file. For instance, the <code>mysql</code> directory contains the exact definitions of the three databases that are used for testing, <code>books</code>, <code>dbconstraints</code>, and <code>university</code>.</p> <p>To prepare the required testing conditions, you can take these <code>.sql</code> files and run their queries on your database. Should any of the features not be supported, you will be required to either use alternative equivalent features to reach the same final database state, or disable the corresponding test cases.</p> <h3 id="preparing-connection-files"><a href="#preparing-connection-files" class="header-anchor">#</a> Preparing Connection Files</h3> <p>The directory <code>test/lightweight-tests/src/test/resources/</code> contains files that are used for setting up an ontop connection with different databases, including <code>.obda</code> files for the VKG creation and <code>.property</code> files for JDBC connections. While the <code>.obda</code> files can usually be reused for different systems, the <code>.property</code> files must be included for each database system. The directories <code>books</code> and <code>prof</code> inside the test resources contain one sub directory for each dialect, where each sub directory in turn includes one <code>.properties</code> file for the JDBC connection. The <code>dbconstraints</code> and <code>university</code> directories, on the other hand, directly contain <code>.property</code> files for each dialect.</p> <p>To run all lightweight tests for a new dialect, the corresponding files and directories have to be creates for its JDBC connection. In particular, the connection files should be created in such a way, that the corresponding database/schema of the test is selected as the default database/schema, as the <code>.obda</code> files access the tables through relative paths.</p> <h3 id="implementing-the-lightweight-test-classes"><a href="#implementing-the-lightweight-test-classes" class="header-anchor">#</a> Implementing the Lightweight Test Classes</h3> <p>The directory <code>test/lightweight-tests/src/test/java/</code> contains the test cases that have to run successfully for each new dialect. They are defined in the four abstract classes <code>AbstractBindTestWithFunctions</code>, <code>AbstractConstraintTest</code>, <code>AbstractDistinctInAggregateTest</code>, and <code>AbstractLeftJoinProfTest</code>.</p> <p>For each new dialect, a new package has to be created at this location, containing the implementations of sub-classes for each of these abstract base classes.</p> <h4 id="bindtestwithfunctions"><a href="#bindtestwithfunctions" class="header-anchor">#</a> <strong><code>BindTestWithFunctions</code></strong></h4> <p>This test class tests all main SQL functions that are supported by ontop. It uses the <code>books</code> database, as well as directly generated data through the SPARQL <code>BIND</code> function. An example implementation of this class may look like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@NewDialectLightweightTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BindWithFunctionsNewDialectTest</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractBindTestWithFunctions</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> PROPERTIES_FILE <span class="token operator">=</span> <span class="token string">&quot;/books/new-dialect/books-new-dialect.properties&quot;</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@BeforeAll</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token function">initOBDA</span><span class="token punctuation">(</span>OBDA_FILE<span class="token punctuation">,</span> OWL_FILE<span class="token punctuation">,</span> PROPERTIES_FILE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@AfterAll</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/*
        ------------------------------------------
        -            Result Definitions          -
        ------------------------------------------
    */</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Using the <code>@NewDialectLightweightTest</code> annotation requires the definition of the annotation in the same package, similarly to how it was defined for other dialects.</p></div> <p>The code block &quot;Result Definitions&quot; is commented out in the above example. This code block may contain redefinitions of expected results that are tested in the base class. To do this, override the <code>get[TEST-NAME]ExpectedValues()</code> method here. An example implementation may look like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token class-name">ImmutableList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getConstantIntegerDivideExpectedResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">ImmutableList</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;\&quot;0.500\&quot;^^xsd:decimal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Should any of the functionalities not be supported by the SQL dialect, then the corresponding test case may simply be disabled with an exaplanation as to why it is not supported. An example for that may look like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Disabled</span><span class="token punctuation">(</span><span class="token string">&quot;New Dialect does not support SHA384&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Test</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testHashSHA384</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">testHashSHA384</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Some test cases are disabled by default.</p> <h4 id="constraint"><a href="#constraint" class="header-anchor">#</a> <strong><code>Constraint</code></strong></h4> <p>This set of test cases tests for the correct interpretation of integrity constraints in the data. It uses the <code>dbconstraints</code> database. An example implementation may look like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@NewDialectLightweightTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConstraintNewDialectTest</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractConstraintTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> PROPERTIES_FILE <span class="token operator">=</span> <span class="token string">&quot;/dbconstraints/dbconstraints-new-dialect.properties&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">ConstraintNewDialectTest</span><span class="token punctuation">(</span><span class="token class-name">String</span> method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> PROPERTIES_FILE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Once again, specific tests may be disabled if they are not supported. For database systems that do not support integrity constraints, this class can be ignored.</p> <h4 id="distinctinaggregate"><a href="#distinctinaggregate" class="header-anchor">#</a> <strong><code>DistinctInAggregate</code></strong></h4> <p>This set of test cases runs queries containing aggregate functions that include the <code>DISTINCT</code> keyword. It can be implemented analogously to the <code>BindWithFunctions</code> test class.</p> <h4 id="leftjoinprof"><a href="#leftjoinprof" class="header-anchor">#</a> <strong><code>LeftJoinProf</code></strong></h4> <p>This set of test cases runs on the <code>university</code> database. It accesses items that have to be taken from the database through <code>JOIN</code>s. Furthermore, it tests the optimization procedures employed by ontop to minimize the required number of joins. Once again, it can be implemented analogously to the <code>BindWithFunctions</code> test class.</p> <p>If the database management system does not support integrity constraints, many of these test cases will fail because the optimizations will not be performed.</p> <h2 id="further-implementations-and-troubleshooting"><a href="#further-implementations-and-troubleshooting" class="header-anchor">#</a> Further Implementations and Troubleshooting</h2> <p>Once the basic features and lightweight test cases have been implemented for a dialect, the tests can be run to determine which features still do not work correctly.</p> <p>If a test case fails, its corresponding feature is likely not yet supported by the current implementation. In these cases, changes need to be applied to the implemented <code>DBTypeFactory</code> or <code>DBFunctionSymbolFactory</code> to solve the issue.</p> <p>In some situations, however, issues may be caused by problems not related to database types or functions. In these cases, one of the following default implementations may also be extended for the new dialect.</p> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>New implementations of these classes have to be linked to the driver through the <code>sql-default.properties</code> file.</p></div> <h3 id="defaultschemacatalogdbmetadataprovider-defaultschemadbmetadataprovider-or-defaultdbmetadataprovider"><a href="#defaultschemacatalogdbmetadataprovider-defaultschemadbmetadataprovider-or-defaultdbmetadataprovider" class="header-anchor">#</a> <strong><code>DefaultSchemaCatalogDBMetadataProvider</code></strong>, <strong><code>DefaultSchemaDBMetadataProvider</code></strong>, or <strong><code>DefaultDBMetadataProvider</code></strong></h3> <p>If the <code>DBMetadataProvider</code> assigned to the dialect is not able to perform its expected actions through its default implementation, it may have to be extended with a new sub-class that is particularly tailored for this dialect.</p> <p>In that case, its methods may be overridden to change the default behavious. Commong targets include:</p> <ul><li><code>insertIntegrityConstraints(...)</code> if the dialect does not support integrity constraints.</li> <li><code>getRelationId(...)</code> to return the ID of a given relation.</li></ul> <p>Additionally, the constructor may be implemented to determine the default schema or default catalog names if they cannot be accessed directly throug the JDBC, or a different <code>QuotedIDFactory</code> instance can be passed to the super-class to force ontop to generate quoted identifiers in a specific way.</p> <h3 id="selectfromwhereserializer"><a href="#selectfromwhereserializer" class="header-anchor">#</a> <strong><code>SelectFromWhereSerializer</code></strong></h3> <p>This class is responsible for the serialization of the SQL query frame. Different SQL dialects have different rules as to how the general shape of an SQL query have to be defined. For instance, some dialects allow users to combine <code>LIMIT</code> and <code>OFFSET</code> clauses as <code>LIMIT &lt;offset&gt;,&lt;limit&gt;</code>, while others require the form <code>OFFSET &lt;offset&gt; LIMIT &lt;limit&gt;</code>. The following shows a default implementation of a <code>SelectFromWhereSerializer</code> to achieve the latter behaviour:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Singleton</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NewDialectSelectFromWhereSerializer</span> <span class="token keyword">extends</span> <span class="token class-name">DefaultSelectFromWhereSerializer</span> <span class="token keyword">implements</span> <span class="token class-name">SelectFromWhereSerializer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Inject</span>
    <span class="token keyword">private</span> <span class="token class-name">NewDialectSelectFromWhereSerializer</span><span class="token punctuation">(</span><span class="token class-name">TermFactory</span> termFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DefaultSQLTermSerializer</span><span class="token punctuation">(</span>termFactory<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">QuerySerialization</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token class-name">SelectFromWhereWithModifiers</span> selectFromWhere<span class="token punctuation">,</span> <span class="token class-name">DBParameters</span> dbParameters<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> selectFromWhere<span class="token punctuation">.</span><span class="token function">acceptVisitor</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">DefaultRelationVisitingSerializer</span><span class="token punctuation">(</span>dbParameters<span class="token punctuation">.</span><span class="token function">getQuotedIDFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">serializeLimitOffset</span><span class="token punctuation">(</span><span class="token keyword">long</span> limit<span class="token punctuation">,</span> <span class="token keyword">long</span> offset<span class="token punctuation">,</span> <span class="token keyword">boolean</span> noSortCondition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;OFFSET %d LIMIT %d&quot;</span><span class="token punctuation">,</span> offset<span class="token punctuation">,</span> limit<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ontop/ontop-website/edit/master/dev/db-adapter.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/21/2025, 1:48:54 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/dev/debug-jetty.html" class="prev">
        Debug Jetty
      </a></span> <span class="next"><a href="/dev/stats.html">
        Statistics
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.eb43982a.js" defer></script><script src="/assets/js/2.ce8d9015.js" defer></script><script src="/assets/js/19.c55473af.js" defer></script>
  </body>
</html>
