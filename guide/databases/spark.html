<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SparkSQL | Ontop</title>
    <meta name="generator" content="VuePress 1.8.2">
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.2b9f24ec.css" as="style"><link rel="preload" href="/assets/js/app.f78a95cb.js" as="script"><link rel="preload" href="/assets/js/2.ce8d9015.js" as="script"><link rel="preload" href="/assets/js/55.67ed2985.js" as="script"><link rel="prefetch" href="/assets/js/10.40e28019.js"><link rel="prefetch" href="/assets/js/100.f68efb0a.js"><link rel="prefetch" href="/assets/js/11.63a0c1c6.js"><link rel="prefetch" href="/assets/js/12.473c4f1c.js"><link rel="prefetch" href="/assets/js/13.9330117e.js"><link rel="prefetch" href="/assets/js/14.cabf7cc1.js"><link rel="prefetch" href="/assets/js/15.8ec0d624.js"><link rel="prefetch" href="/assets/js/16.c4cef8b7.js"><link rel="prefetch" href="/assets/js/17.4d3bdb39.js"><link rel="prefetch" href="/assets/js/18.1de16b6c.js"><link rel="prefetch" href="/assets/js/19.c55473af.js"><link rel="prefetch" href="/assets/js/20.647b4013.js"><link rel="prefetch" href="/assets/js/21.8e93c882.js"><link rel="prefetch" href="/assets/js/22.00571580.js"><link rel="prefetch" href="/assets/js/23.43b5e0ca.js"><link rel="prefetch" href="/assets/js/24.e8f61543.js"><link rel="prefetch" href="/assets/js/25.022d34d2.js"><link rel="prefetch" href="/assets/js/26.6fb83462.js"><link rel="prefetch" href="/assets/js/27.1d29815b.js"><link rel="prefetch" href="/assets/js/28.b36f0407.js"><link rel="prefetch" href="/assets/js/29.6957445c.js"><link rel="prefetch" href="/assets/js/3.b7f6ec10.js"><link rel="prefetch" href="/assets/js/30.a3858dfb.js"><link rel="prefetch" href="/assets/js/31.de926e6b.js"><link rel="prefetch" href="/assets/js/32.bbc94ac1.js"><link rel="prefetch" href="/assets/js/33.45b3ef2c.js"><link rel="prefetch" href="/assets/js/34.5fd26f8f.js"><link rel="prefetch" href="/assets/js/35.9e166cc5.js"><link rel="prefetch" href="/assets/js/36.c44deccc.js"><link rel="prefetch" href="/assets/js/37.6ac35316.js"><link rel="prefetch" href="/assets/js/38.03ed20e0.js"><link rel="prefetch" href="/assets/js/39.aec49c79.js"><link rel="prefetch" href="/assets/js/4.1ae9de1c.js"><link rel="prefetch" href="/assets/js/40.f2a17819.js"><link rel="prefetch" href="/assets/js/41.8783e3b4.js"><link rel="prefetch" href="/assets/js/42.605d70b3.js"><link rel="prefetch" href="/assets/js/43.c48fe62d.js"><link rel="prefetch" href="/assets/js/44.b45be0fb.js"><link rel="prefetch" href="/assets/js/45.6782ae9a.js"><link rel="prefetch" href="/assets/js/46.47be9e9f.js"><link rel="prefetch" href="/assets/js/47.6398aaec.js"><link rel="prefetch" href="/assets/js/48.ae920e84.js"><link rel="prefetch" href="/assets/js/49.31e8374c.js"><link rel="prefetch" href="/assets/js/5.e8e9de00.js"><link rel="prefetch" href="/assets/js/50.a6d14188.js"><link rel="prefetch" href="/assets/js/51.d1069607.js"><link rel="prefetch" href="/assets/js/52.184b92b3.js"><link rel="prefetch" href="/assets/js/53.98db20f5.js"><link rel="prefetch" href="/assets/js/54.fc0ed059.js"><link rel="prefetch" href="/assets/js/56.4b4edba3.js"><link rel="prefetch" href="/assets/js/57.a635467f.js"><link rel="prefetch" href="/assets/js/58.587c2188.js"><link rel="prefetch" href="/assets/js/59.0d26da10.js"><link rel="prefetch" href="/assets/js/6.e48edabd.js"><link rel="prefetch" href="/assets/js/60.dad55ac2.js"><link rel="prefetch" href="/assets/js/61.9a9c02a3.js"><link rel="prefetch" href="/assets/js/62.d2593334.js"><link rel="prefetch" href="/assets/js/63.88b74908.js"><link rel="prefetch" href="/assets/js/64.ef1c6023.js"><link rel="prefetch" href="/assets/js/65.cf925936.js"><link rel="prefetch" href="/assets/js/66.60d5b021.js"><link rel="prefetch" href="/assets/js/67.1aca7721.js"><link rel="prefetch" href="/assets/js/68.2aa9315d.js"><link rel="prefetch" href="/assets/js/69.0fea1cc6.js"><link rel="prefetch" href="/assets/js/7.e665b7ff.js"><link rel="prefetch" href="/assets/js/70.390c1b51.js"><link rel="prefetch" href="/assets/js/71.828a156a.js"><link rel="prefetch" href="/assets/js/72.0b75bd8c.js"><link rel="prefetch" href="/assets/js/73.9fed8728.js"><link rel="prefetch" href="/assets/js/74.601e7783.js"><link rel="prefetch" href="/assets/js/75.5f9e9c52.js"><link rel="prefetch" href="/assets/js/76.96406f20.js"><link rel="prefetch" href="/assets/js/77.4257ac6f.js"><link rel="prefetch" href="/assets/js/78.8c0cdac5.js"><link rel="prefetch" href="/assets/js/79.28837695.js"><link rel="prefetch" href="/assets/js/8.a24e3ea0.js"><link rel="prefetch" href="/assets/js/80.e24f897b.js"><link rel="prefetch" href="/assets/js/81.6698c80e.js"><link rel="prefetch" href="/assets/js/82.110d224d.js"><link rel="prefetch" href="/assets/js/83.e3f4fe9e.js"><link rel="prefetch" href="/assets/js/84.89d4f971.js"><link rel="prefetch" href="/assets/js/85.a5d90bdd.js"><link rel="prefetch" href="/assets/js/86.88b669e2.js"><link rel="prefetch" href="/assets/js/87.0bff43af.js"><link rel="prefetch" href="/assets/js/88.41f05188.js"><link rel="prefetch" href="/assets/js/89.bb41254d.js"><link rel="prefetch" href="/assets/js/9.2397fef4.js"><link rel="prefetch" href="/assets/js/90.ebfcdd76.js"><link rel="prefetch" href="/assets/js/91.df2955b2.js"><link rel="prefetch" href="/assets/js/92.94a50a19.js"><link rel="prefetch" href="/assets/js/93.345dfe74.js"><link rel="prefetch" href="/assets/js/94.9b38d890.js"><link rel="prefetch" href="/assets/js/95.5ebe6cd9.js"><link rel="prefetch" href="/assets/js/96.399936b5.js"><link rel="prefetch" href="/assets/js/97.eb71dfa4.js"><link rel="prefetch" href="/assets/js/98.f5e3d29a.js"><link rel="prefetch" href="/assets/js/99.34985a57.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2b9f24ec.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Ontop</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/tutorial/" class="nav-link">
  Tutorial
</a></div><div class="nav-item"><a href="/download/" class="nav-link">
  Download
</a></div><div class="nav-item"><a href="/community/" class="nav-link">
  Community
</a></div><div class="nav-item"><a href="/research/" class="nav-link">
  Research
</a></div><div class="nav-item"><a href="/dev/" class="nav-link">
  Dev
</a></div><div class="nav-item"><a href="/jobs/" class="nav-link">
  Work with us
</a></div> <a href="https://github.com/ontop/ontop" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/tutorial/" class="nav-link">
  Tutorial
</a></div><div class="nav-item"><a href="/download/" class="nav-link">
  Download
</a></div><div class="nav-item"><a href="/community/" class="nav-link">
  Community
</a></div><div class="nav-item"><a href="/research/" class="nav-link">
  Research
</a></div><div class="nav-item"><a href="/dev/" class="nav-link">
  Dev
</a></div><div class="nav-item"><a href="/jobs/" class="nav-link">
  Work with us
</a></div> <a href="https://github.com/ontop/ontop" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/guide/concepts.html" class="sidebar-link">Key concepts</a></li><li><a href="/guide/getting-started.html" class="sidebar-link">Getting started</a></li><li><a href="/guide/cli.html" class="sidebar-link">Command Line Interface</a></li><li><a href="/guide/compliance.html" class="sidebar-link">Standards compliance</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Advanced</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/advanced/predefined.html" class="sidebar-link">Predefined query endpoint (beta)</a></li><li><a href="/guide/advanced/logging.html" class="sidebar-link">Query logging</a></li><li><a href="/guide/advanced/caching.html" class="sidebar-link">HTTP caching</a></li><li><a href="/guide/advanced/configuration.html" class="sidebar-link">Configuration keys</a></li><li><a href="/guide/advanced/lenses.html" class="sidebar-link">Lenses</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Data sources</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/databases/generic.html" class="sidebar-link">Generic JDBC (not recommended)</a></li><li><a href="/guide/databases/athena.html" class="sidebar-link">AWS Athena</a></li><li><a href="/guide/databases/dynamodb.html" class="sidebar-link">AWS DynamoDB</a></li><li><a href="/guide/databases/redshift.html" class="sidebar-link">AWS Redshift</a></li><li><a href="/guide/databases/databricks.html" class="sidebar-link">Databricks</a></li><li><a href="/guide/databases/db2.html" class="sidebar-link">DB2</a></li><li><a href="/guide/databases/denodo.html" class="sidebar-link">Denodo</a></li><li><a href="/guide/databases/dremio.html" class="sidebar-link">Dremio</a></li><li><a href="/guide/databases/duckdb.html" class="sidebar-link">DuckDB</a></li><li><a href="/guide/databases/bigquery.html" class="sidebar-link">Google BigQuery</a></li><li><a href="/guide/databases/h2.html" class="sidebar-link">H2</a></li><li><a href="/guide/databases/mariadb.html" class="sidebar-link">MariaDB</a></li><li><a href="/guide/databases/mssql.html" class="sidebar-link">MS SQL Server</a></li><li><a href="/guide/databases/mysql.html" class="sidebar-link">MySQL</a></li><li><a href="/guide/databases/oracle.html" class="sidebar-link">Oracle</a></li><li><a href="/guide/databases/postgres.html" class="sidebar-link">PostgreSQL</a></li><li><a href="/guide/databases/presto.html" class="sidebar-link">Presto</a></li><li><a href="/guide/databases/snowflake.html" class="sidebar-link">Snowflake</a></li><li><a href="/guide/databases/spark.html" aria-current="page" class="active sidebar-link">SparkSQL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/databases/spark.html#limitations-exceptions" class="sidebar-link">Limitations &amp; Exceptions</a></li><li class="sidebar-sub-header"><a href="/guide/databases/spark.html#database-connection" class="sidebar-link">Database Connection</a></li><li class="sidebar-sub-header"><a href="/guide/databases/spark.html#nested-type-support" class="sidebar-link">Nested Type Support</a></li></ul></li><li><a href="/guide/databases/trino.html" class="sidebar-link">Trino</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Troubleshooting</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/troubleshooting/faq.html" class="sidebar-link">FAQ</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Meta</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/glossary.html" class="sidebar-link">Glossary</a></li><li><a href="/guide/releases.html" class="sidebar-link">Release notes</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="sparksql"><a href="#sparksql" class="header-anchor">#</a> SparkSQL</h1> <p><em>Supported since 4.2.0.</em></p> <p>Through the <a href="https://spark.apache.org/" target="_blank" rel="noopener">SparkSQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> connector, Ontop is able to construct VKGs on an external Spark database, using the SparkSQL JDBC.</p> <h2 id="limitations-exceptions"><a href="#limitations-exceptions" class="header-anchor">#</a> Limitations &amp; Exceptions</h2> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>SparkSQL does not provide information about integrity constraints. Make sure to provide this information in order to avoid very inefficient queries.
We recommend using <a href="/guide/advanced/lenses">lenses</a> for this purpose.</p></div> <ul><li>Accessing struct fields with the &quot;dot operator&quot; is not supported (see below).</li></ul> <h2 id="database-connection"><a href="#database-connection" class="header-anchor">#</a> Database Connection</h2> <p>The following shows the content of a sample <code>.properties</code> file that can be used to connect Ontop to SparkSQL using the JDBC Hive Driver:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>jdbc.url<span class="token operator">=</span>jdbc:hive2://localhost:10000
jdbc.driver <span class="token operator">=</span> org.apache.hive.jdbc.HiveDriver
jdbc.user <span class="token operator">=</span> user
jdbc.password <span class="token operator">=</span> password
</code></pre></div><h2 id="nested-type-support"><a href="#nested-type-support" class="header-anchor">#</a> Nested Type Support</h2> <p>Ontop implements explicit compatibility with the SparkSQL array type <code>Array&lt;T&gt;</code>. When used with the <a href="/guide/advanced/lenses#flattenlens">flatten lens</a>, it is able to automatically infer the type of the result column.</p> <p>Furthermore, the flatten lens can also be used with the JSON-encoded string columns. For these columns, however, Ontop cannot infer the output type of the flattened column.</p> <h3 id="struct-access"><a href="#struct-access" class="header-anchor">#</a> Struct Access</h3> <p>In SparkSQL, individual struct objects can be accessed by SQL expressions using the &quot;dot operator&quot; on the struct column. In Ontop, this feature is not currently supported.</p> <p>Should any of their elements still be required, then a workaround can be performed by first transforming the struct into a JSON object and then accessing it using JSON functions.</p> <p>Example:</p> <p><code>my_struct.my_attribute</code> <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" viewBox="0 -511 1000 522" style="vertical-align:-0.025ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg></mjx-container> <code>GET_JSON_OBJECT(TO_JSON(my_struct), '$.my_attribute')</code></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ontop/ontop-website/edit/master/guide/databases/spark.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/6/2024, 12:58:44 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/databases/snowflake.html" class="prev">
        Snowflake
      </a></span> <span class="next"><a href="/guide/databases/trino.html">
        Trino
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f78a95cb.js" defer></script><script src="/assets/js/2.ce8d9015.js" defer></script><script src="/assets/js/55.67ed2985.js" defer></script>
  </body>
</html>
